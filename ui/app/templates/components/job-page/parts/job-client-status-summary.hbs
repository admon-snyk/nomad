<ListAccordion
  data-test-job-summary
  @source={{array this.job}}
  @key="id"
  @startExpanded={{this.isExpanded}}
  @onToggle={{action this.persist}} as |a|
>
  <a.head @buttonLabel={{if a.isOpen "collapse" "expand"}}>
    <div class="columns">
      <div class="column is-minimum nowrap">
        Job Status in Client
        <span class="badge {{if a.isOpen "is-white" "is-light"}}">
          {{this.jobClientStatus.totalNodes}}
        </span>
      </div>
      {{#unless a.isOpen}}
        <div class="column">
          <div class="inline-chart bumper-left">
            <JobClientStatusBar
              @onSliceClick={{this.onSliceClick}}
              @jobClientStatus={{this.jobClientStatus}}
              @isNarrow={{true}}
            />
          </div>
        </div>
      {{/unless}}
    </div>
  </a.head>
  <a.body>
    <JobClientStatusBar
      @onSliceClick={{this.onSliceClick}}
      @jobClientStatus={{this.jobClientStatus}}
      class="split-view" as |chart|
    >
      <ol data-test-legend class="legend">
        {{#each chart.data as |datum index|}}
          <li
            class="{{datum.className}}

              {{if (eq datum.label chart.activeDatum.label) "is-active"}}

              {{if (eq datum.value 0) "is-empty"}}"
          >
            <span
              class="color-swatch {{if datum.className datum.className (concat "swatch-" index)}}"
            ></span>
            <span class="value" data-test-legend-value="{{datum.className}}">
              {{datum.value}}
            </span>
            <span class="label">
              {{datum.label}}
            </span>
          </li>
        {{/each}}
      </ol>
    </JobClientStatusBar>
  </a.body>
</ListAccordion>